
1.--

Learning Objectives--

-
Learning Objectives
In this lesson you will learn about:
Regression Algorithms 
Model Evaluation 
Model Evaluation: Overfitting & Underfitting
Understanding Different Evaluation Models
Simple Linear Regression
---------------------------------------------------------------------------

2.--Intro to Regression 

The question is, "Given this dataset, can we predict the Co2 emission of a car using
other fields, such as EngineSize or Cylinders?"

We can use regression methods to predict a continuous value, such as CO2 Emission, using
some other variables.
--
Regression::::

-"Indeed, regression is the process of predicting a continuous value.
In regression there are two types of variables: a dependent variable and one or more independent
variables."

The dependent variable can be seen as the "state", "target" or "final goal" we study
and try to predict, and the independent variables, also known as explanatory variables, can be
seen as the "causes" of those "states".
-
The independent variables are shown conventionally by x; and the dependent variable is notated
by y.
A regression model relates y, or the dependent variable, to a function of x, i.e., the independent
variables.
The key point in the regression is that our dependent value should be continuous, and
cannot be a discreet value.
However, the independent variable or variables can be measured on either a categorical or
continuous measurement scale.
-
So, what we want to do here is to use the historical data of some cars, using one or
more of their features, and from that data, make a model.
We use regression to build such a regression/estimation model.
Then the model is used to predict the expected Co2 emission for a new or unknown car.
--
TYPES Of REGRESSION--

Basically there are 2 types of regression models: simple regression and multiple regression.
Simple regression is when one independent variable is used to estimate a dependent variable.
It can be either linear on non-linear.
For example, predicting Co2emission using the variable of EngineSize.
Linearity of regression is based on the nature of relationship between independent and dependent
variables.

When more than one independent variable is present, the process is called multiple linear
regression.

For example, predicting Co2emission using EngineSize and the number of Cylinders in
any given car.

Again, depending on the relation between dependent and independent variables, it can be either
linear or non-linear regression.


-use-
Essentially, we use regression when we want to estimate a continuous value.

-
You can try to predict a salesperson's total yearly sales from independent variables such
as age, education, and years of experience.
It can also be used in the field of psychology, for example, to determine individual satisfaction
based on demographic and psychological factors.
We can use regression analysis to predict the price of a house in an area, based on its
size, number of bedrooms, and so on.
We can even use it to predict employment income for independent variables, such as hours of
work, education, occupation, sex, age, years of experience, and so on.

We have many regression algorithms.
Each of them has its own importance and a specific condition to which their application
is best suited.

-------------------------------------------------------------------------
3.Simple Linear Regression::

The question is: Given this dataset, can we
predict the Co2 emission of a car, using another field, such as Engine size?
Quite simply, yes! We can use linear regression to predict a
continuous value such as Co2 Emission, by using other variables.

-Definition-Linear regression is the approximation of a linear model used to describe the relationship
between two or more variables. In simple linear regression, there are two
variables: a dependent variable and an independent variable.

-The key point- in the linear regression is that our dependent value should be continuous
and cannot be a discreet value. However, the independent variable(s) can be
measured on either a categorical or continuous measurement scale.

#TYPES OF REGRESSION--
There are two types of linear regression models. They are: 
3.1.-simple regression and 
3.2-multiple regression.

3.1-Simple linear regression is when one independent variable is used to estimate
a dependent variable. 
For example, predicting Co2 emission using
the EngineSize variable.

3.2-When more than one independent variable is
present, the process is called multiple linear regression.
For example, predicting Co2 emission using EngineSize and Cylinders of cars.


----
Simple linear gegression---

To understand linear regression, we can plot our variables here.
We show Engine size as an independent variable, and Emission as the target value that we would
like to predict. A scatterplot clearly shows the relation between
variables where changes in one variable "explain" or possibly "cause" changes in the other variable.
Also, it indicates that these variables are linearly related.
With linear regression you can fit a line through the data.
For instance, as the EngineSize increases, so do the emissions.
With linear regression, you can model the relationship of these variables.
A good model can be used to predict what the approximate emission of each car is.
How do we use this line for prediction now? Let us assume, for a moment, that the line
is a good fit of data. We can use it to predict the emission of an
unknown car. For example, for a sample car, with engine
size 2.4, you can find the emission is 214.

--
Now, letâ€™s talk about what this fitting line actually is.
Weâ€™re going to predict the target value, y.
In our case, using the independent variable, "Engine Size," represented by x1.
The fit line is shown traditionally as a polynomial. In a simple regression problem (a single x),
the form of the model would be Î¸0 +Î¸1 x1. In this equation, y Ì‚ is the dependent variable
or the predicted value, and x1 is the independent variable; Î¸0 and Î¸1 are the parameters of
the line that we must adjust. Î¸1 is known as the "slope" or "gradient"
of the fitting line and Î¸0 is known as the "intercept."
Î¸0 and Î¸1 are also called the coefficients of the linear equation.
You can interpret this equation as y Ì‚ being a function of x1, or y Ì‚ being dependent of x1.
Now the questions are: "How would you draw
a line through the points?" And, "How do you determine which line â€˜fits
bestâ€™?"
Linear regression estimates the coefficients of the line.
This means we must calculate Î¸0 and Î¸1 to find the best line to â€˜fitâ€™ the data.
This line would best estimate the emission of the unknown data points.
Letâ€™s see how we can find this line, or to be more precise, how we can adjust the
parameters to make the line the best fit for the data.
For a moment, letâ€™s assume weâ€™ve already found the best fit line for our data.
Now, letâ€™s go through all the points and check how well they align with this line.
Best fit, here, means that if we have, for instance, a car with engine size x1=5.4, and
actual Co2=250, its Co2 should be predicted very close to the actual value, which is y=250,
based on historical data.
But, if we use the fit line, or better to say, using our polynomial with known parameters
to predict the Co2 emission, it will return y Ì‚ =340.
Now, if you compare the actual value of the emission of the car with what we predicted
using our model, you will find out that we have a 90-unit error.

-This means our prediction line is not accurate. This error is also called the residual error.
So, we can say the error is the distance from the data point to the fitted regression line.
The mean of all residual errors shows how poorly the line fits with the whole dataset.

-Accuracy--
Mathematically, it can be shown by the equation, mean squared error, shown as (MSE).
Our objective is to find a line where the mean of all these errors is minimized.
In other words, the mean error of the prediction using the fit line should be minimized.
Letâ€™s re-word it more technically. The objective of linear regression is to minimize
this MSE equation, and to minimize it, we should find the best parameters, Î¸0 and Î¸1.
Now, the question is, how to find Î¸0 and Î¸1 in such a way that it minimizes this error?
How can we find such a perfect line? Or, said another way, how should we find the
best parameters for our line? Should we move the line a lot randomly and
calculate the MSE value every time, and choose the minimum one?

------------------------------------------------
2.6.3-Estimating parameters of linear regression::

Option 1 - We can use a mathematic approach. Or, Option 2 - We can use an optimization
approach.
Letâ€™s see how we can easily use a mathematic formula to find the Î¸0 and Î¸1.
As mentioned before, Î¸0 and Î¸1, in the simple linear regression, are the coefficients of
the fit line. We can use a simple equation to estimate these
coefficients. That is, given that itâ€™s a simple linear
regression, with only 2 parameters, and knowing that Î¸0 and Î¸1 are the intercept and slope
of the line, we can estimate them directly from our data.
It requires that we calculate the mean of the independent and dependent or target columns,
from the dataset. Notice that all of the data must be available
to traverse and calculate the parameters. It can be shown that the intercept and slope
can be calculated using these equations. We can start off by estimating the value for Î¸1.
This is how you can find the slope of a line
based on the data. x Ì… is the average value for the engine size
in our dataset. Please consider that we have 9 rows here,
row 0 to 8. First, we calculate the average of x1 and
average of y. Then we plug it into the slope equation, to
find Î¸1. The xi and yi in the equation refer to the
fact that we need to repeat these calculations across all values in our dataset and i refers
to the iâ€™th value of x or y.
Applying all values, we find Î¸1=39; it is our second parameter.
It is used to calculate the first parameter, which is the intercept of the line.
Now, we can plug Î¸1 into the line equation to find Î¸0.
It is easily calculated that Î¸0=125.74. So, these are the two parameters for the line,
where Î¸0 is also called the bias coefficient and Î¸1 is the coefficient for the Co2 Emission
column. As a side note, you really donâ€™t need to
remember the formula for calculating these parameters, as most of the libraries used
for machine learning in Python, R, and Scala can easily find these parameters for you.
But itâ€™s always good to understand how it works.
Now, we can write down the polynomial of the line.
So, we know how to find the best fit for our data, and its equation.
Now the question is: "How can we use it to predict the emission of a new car based on
its engine size?"
After we found the parameters of the linear equation, making predictions is as simple
as solving the equation for a specific set of inputs.
Imagine we are predicting Co2 Emission (y) from EngineSize (x) for the Automobile in record
number 9. Our linear regression model representation
for this problem would be: y Ì‚ = Î¸0 + Î¸1 x1.
Or if we map it to our dataset, it would be Co2Emission = Î¸0 + Î¸1 EngineSize.
As we saw, we can find Î¸0, Î¸1 using the equations that we just talked about.
Once found, we can plug in the equation of the linear model.
For example, letâ€™s use Î¸0=125 and Î¸1=39. So, we can rewrite the linear model as ğ¶ğ‘œ2ğ¸ğ‘šğ‘–ğ‘ ğ‘ ğ‘–ğ‘œğ‘›=125+39ğ¸ğ‘›ğ‘”ğ‘–ğ‘›ğ‘’ğ‘†ğ‘–ğ‘§ğ‘’.
Now, letâ€™s plug in the 9th row of our dataset and calculate the Co2 Emission for a car with
an EngineSize of 2.4. So Co2Emission = 125 + 39 Ã— 2.4.
Therefore, we can predict that the Co2 Emission for this specific car would be 218.6.
Letâ€™s talk a bit about why Linear Regression is so useful.
Quite simply, it is the most basic regression to use and understand.
In fact, one reason why Linear Regression is so useful is that itâ€™s fast!
It also doesnâ€™t require tuning of parameters. So, something like tuning the K parameter
in K-Nearest Neighbors or the learning rate in Neural Networks isnâ€™t something to worry
about. Linear Regression is also easy to understand
and highly interpretable.
-------------------------------------



